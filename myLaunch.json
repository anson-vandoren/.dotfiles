{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "type": "node",
            "request": "attach",
            "name": "Attach to Remote",
            "address": "${input:ip}",
            "port": 9229,
            "localRoot": "${workspaceFolder}",
            "remoteRoot": "/opt/cribl/bin/"
        },
        {
            "type": "node",
            "request": "launch",
            "name": "nodemon",
            "runtimeExecutable": "nodemon",
            "program": "${workspaceFolder}/dist/sluice/bin/cribl.bundle.js",
            "restart": true,
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen",
            "args": ["server"],
            "env": {
                "CRIBL_NOAUTH": "1",

            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "wp",
            "runtimeExecutable": "${workspaceFolder}/node_modules/webpack/bin/webpack.js",
            "runtimeArgs": ["--config",  "webpack.config.sluice.js"],
            "restart": true,
            "cwd": "${workspaceFolder}",
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen",
            "env": {
                "NODE_ENV": "dev",
                "BAD_FENCES": "1"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch Sluice Tests via NPM",
            "runtimeExecutable": "npm",
            "sourceMapRenames": false,
            "runtimeArgs": [
                "run-script",
                "run-tests",
                "--",
                "sluice",
                "--inspect-brk",
                "--grep=${input:testName}"
            ],
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch Search Tests via NPM",
            "runtimeExecutable": "npm",
            "sourceMapRenames": false,
            "runtimeArgs": [
                "run-script",
                "run-tests",
                "--",
                "sluice/js/search",
                "--inspect-brk",
                "--grep=${input:testName}"
            ],
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch Base Tests via NPM",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run-script",
                "test-base",
                "--",
                "--inspect-brk",
                "--grep=${input:testName}"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch Expr Tests via NPM",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run-script",
                "test-expr",
                "--",
                "--inspect-brk",
                "--grep=${input:testName}"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch rest Tests via NPM",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run-script",
                "test-rest",
                "--",
                "-g",
                "${input:testName}"
            ],
            "env": {
                "NATIVE_BUILD": "0"
            }

        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch NPM task",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run-script",
                "${input:npmTask}",
                "--inspect-brk",
            ],
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Debug UI tests in currently open file",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run-script",
                "test-ui-specific",
                "--inspect-brk",
                "--",
                "${relativeFile}",
            ],
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {
            "type": "node",
            "request": "attach",
            "name": "Attach by Process ID",
            "processId": "${command:PickProcess}",
            "sourceMapRenames":false,
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
        },
        {
            "type": "node",
            "request": "launch",
            "name": "debug all tests",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run-script",
                "test-all",
                "--",
                "--inspect-brk=9229"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0"
            }
        },
        {

            "type": "node",
            "request": "launch",
            "name": "Launch Single Test",
            "runtimeExecutable": "npx",
            "runtimeArgs": [
                "mocha",
                "${input:testFile}"
            ],
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0",
                "NODE_ENV":"test"
            }
        },
        {

            "type": "node",
            "request": "launch",
            "name": "Launch Single Edge",
            "runtimeExecutable": "node",
            "runtimeArgs": [
                "/home/parallels/dev/cribl/node_modules/.bin/mocha",
                "--opts",
                "/home/parallels/dev/cribl/test/mocha.opts",
                " /home/parallels/dev/cribl/src/sluice/js/edge/__tests__/*.ts",
                "-g",
                "${input:testName}"
            ],
            "skipFiles": [
                "<node_internals>/**/*.js"
            ],
            "port": 9229,
            "env": {
                "NATIVE_BUILD": "0",
                "NODE_ENV":"test"
            }
        },
        {
            "type": "chrome",
            "request": "attach",
            "name": "Attach to Chrome",
            "port": 9222,
            "webRoot": "${workspaceFolder}"
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch Dev Sluice",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run",
                "dev-sluice",
                "--",
                "--inspect-brk=9229"
            ],
            "port": 9229,
            "env": {
                "CRIBL_NOAUTH": "1"
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Launch Dev Dist",
            "runtimeExecutable": "npm",
            "runtimeArgs": [
                "run",
                "dev-dist",
                "--",
                "--inspect-brk=9229"
            ],
            "port": 9229,
            "env": {
                "CRIBL_NOAUTH": "1",
            }
        },
        {
            "type": "node",
            "request": "launch",
            "name": "Debug ui tests",
            "runtimeExecutable": "${workspaceFolder}/node_modules/.bin/jest",
            "runtimeArgs": [
                "--runInBand",
                "--config",
                "./config-ui/jest.config.js",
                "--watchAll=false",
                "--verbose=true",
                "${input:jestTestName}"
            ],
            "console": "integratedTerminal",
            "internalConsoleOptions": "neverOpen",
            "disableOptimisticBPs": true,
            "env": {
                "NODE_ENV":"test"
            },
            "windows": {
              "program": "${workspaceFolder}/node_modules/jest/bin/jest",
            }
          },
    ],
    "inputs": [
        {
            "id": "testName",
            "type": "command",
            "command": "memento.promptString",
            "args": {
                "id": "testName",
                "default": ".*",
                "description": "String to feed to mocha grep"
            }
        },
        {
            "id": "jestTestName",
            "description": "Name of the test to run",
            "type": "promptString",
            "default": ".*"
        },
        {
            "id": "ip",
            "type": "promptString",
            "description": "IP Address of remote",
            "default": "localhost"
        },
        {
            "id": "npmTask",
            "type": "promptString",
            "description": "NPM task",
            "default": ""
        },
        {
            "id": "testFile",
            "description": "path to the TS file containing the tests",
            "type": "promptString"
        }
    ]
}
